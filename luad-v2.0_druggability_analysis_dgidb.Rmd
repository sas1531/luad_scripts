---
title: "luad-v.2.0_druggability_2"
author: "Shaleigh Smith"
date: "5/21/2019"
output: html_document
---




---

Modified druggability Analysis 

---

```{r}

library(tidyverse)
library(dplyr)
library(rDGIdb)
library(plyr)
library(data.table)
library(ComplexHeatmap)
library(circlize)
library(RColorBrewer)
library(tidyr)

```


---

```{r}

##### 2 Group All Upregulated, filtered for DGIDB direct interaction list: Phosphoproteome #####

# Read in all phosphoproteome significant outliers 
# join all by gene name
# leave significance 
# make this into a heatmap


gender_all <- read.table("./comparison_results_1_dgidb_fdr_0.01/luad2_phos_dgidb_Gender_up_female__male____sig_outliers.txt", header = TRUE, sep = "\t")
gender_all$GeneSymbol <- as.character(gender_all$GeneSymbol)
colnames(gender_all)[2] <- "gender_all"

region_all <- read.table("./comparison_results_1_dgidb_fdr_0.01/luad2_phos_dgidb_Region_up_asian__western____sig_outliers.txt", header = TRUE, sep = "\t")
region_all$GeneSymbol <- as.character(region_all$GeneSymbol)
colnames(region_all)[2] <- "region_all"

smoking_all <- read.table("./comparison_results_1_dgidb_fdr_0.01/luad2_phos_dgidb_Smoking_up_smoker__non-smoker____sig_outliers.txt", header = TRUE, sep = "\t")
smoking_all$GeneSymbol <- as.character(smoking_all$GeneSymbol)
colnames(smoking_all)[2] <- "smoking_all"

egfr_all <- read.table("./comparison_results_1_dgidb_fdr_0.01/luad2_phos_dgidb_EGFR_up_1__0____sig_outliers.txt", header = TRUE, sep = "\t")
egfr_all$GeneSymbol <- as.character(egfr_all$GeneSymbol)
colnames(egfr_all)[2] <- "egfr_all"

kras_all <- read.table("./comparison_results_1_dgidb_fdr_0.01/luad2_phos_dgidb_KRAS_up_1__0____sig_outliers.txt", header = TRUE, sep = "\t")
kras_all$GeneSymbol <- as.character(kras_all$GeneSymbol)
colnames(kras_all)[2] <- "kras_all"

tp53_all <- read.table("./comparison_results_1_dgidb_fdr_0.01/luad2_phos_dgidb_TP53_up_1__0____sig_outliers.txt", header = TRUE, sep = "\t")
tp53_all$GeneSymbol <- as.character(tp53_all$GeneSymbol)
colnames(tp53_all)[2] <- "tp53_all"

egfr_female <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Gender_EGFR_up_female_1_female_0___sig_outliers.txt", header = TRUE, sep = "\t")
egfr_female$GeneSymbol <- as.character(egfr_female$GeneSymbol)
colnames(egfr_female)[2] <- "egfr_female"

egfr_male <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Gender_EGFR_up_male_1_male_0___sig_outliers.txt", header = TRUE, sep = "\t")
egfr_male$GeneSymbol <- as.character(egfr_male$GeneSymbol)
colnames(egfr_male)[2] <- "egfr_male"

kras_female <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Gender_KRAS_up_female_1_female_0___sig_outliers.txt", header = TRUE, sep = "\t")
kras_female$GeneSymbol <- as.character(kras_female$GeneSymbol)
colnames(kras_female)[2] <- "kras_female"

kras_male <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Gender_KRAS_up_male_1_male_0___sig_outliers.txt", header = TRUE, sep = "\t")
kras_male$GeneSymbol <- as.character(kras_male$GeneSymbol)
colnames(kras_male)[2] <- "kras_male"

tp53_female <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Gender_TP53_up_female_1_female_0___sig_outliers.txt", header = TRUE, sep = "\t")
tp53_female$GeneSymbol <- as.character(tp53_female$GeneSymbol)
colnames(tp53_female)[2] <- "tp53_female"

tp53_male <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Gender_TP53_up_male_1_male_0___sig_outliers.txt", header = TRUE, sep = "\t")
tp53_male$GeneSymbol <- as.character(tp53_male$GeneSymbol)
colnames(tp53_male)[2] <- "tp53_male"

egfr_asian <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Region_EGFR_up_asian_1_asian_0___sig_outliers.txt", header = TRUE, sep = "\t")
egfr_asian$GeneSymbol <- as.character(egfr_asian$GeneSymbol)
colnames(egfr_asian)[2] <- "egfr_asian"

egfr_western <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Region_EGFR_up_western_1_western_0___sig_outliers.txt", header = TRUE, sep = "\t")
egfr_western$GeneSymbol <- as.character(egfr_western$GeneSymbol)
colnames(egfr_western)[2] <- "egfr_western"

gender_asian <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Region_Gender_up_asian_female_asian_male___sig_outliers.txt", header = TRUE, sep = "\t")
gender_asian$GeneSymbol <- as.character(gender_asian$GeneSymbol)
colnames(gender_asian)[2] <- "gender_asian"

region_female <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Region_Gender_up_asian_female_western_female___sig_outliers.txt", header = TRUE, sep = "\t")
region_female$GeneSymbol <- as.character(region_female$GeneSymbol)
colnames(region_female)[2] <- "region_female"

region_male <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Region_Gender_up_asian_male_western_male___sig_outliers.txt", header = TRUE, sep = "\t")
region_male$GeneSymbol <- as.character(region_male$GeneSymbol)
colnames(region_male)[2] <- "region_male"

gender_western <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Region_Gender_up_western_female_western_male___sig_outliers.txt", header = TRUE, sep = "\t")
gender_western$GeneSymbol <- as.character(gender_western$GeneSymbol)
colnames(gender_western)[2] <- "gender_western"

kras_asian <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Region_KRAS_up_asian_1_asian_0___sig_outliers.txt", header = TRUE, sep = "\t")
kras_asian$GeneSymbol <- as.character(kras_asian$GeneSymbol)
colnames(kras_asian)[2] <- "kras_asian"

kras_western <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Region_KRAS_up_western_1_western_0___sig_outliers.txt", header = TRUE, sep = "\t")
kras_western$GeneSymbol <- as.character(kras_western$GeneSymbol)
colnames(kras_western)[2] <- "kras_western"

tp53_asian <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Region_TP53_up_asian_1_asian_0___sig_outliers.txt", header = TRUE, sep = "\t")
tp53_asian$GeneSymbol <- as.character(tp53_asian$GeneSymbol)
colnames(tp53_asian)[2] <- "tp53_asian"

tp53_western <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Region_TP53_up_western_1_western_0___sig_outliers.txt", header = TRUE, sep = "\t")
tp53_western$GeneSymbol <- as.character(tp53_western$GeneSymbol)
colnames(tp53_western)[2] <- "tp53_western"

smoker_female <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Smoking_Gender_up_smoker_female_non-smoker_female___sig_outliers.txt", header = TRUE, sep = "\t")
smoker_female$GeneSymbol <- as.character(smoker_female$GeneSymbol)
colnames(smoker_female)[2] <- "smoker_female"

#smoker_male <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Smoking_Gender_up_smoker_male_non-smoker_male___sig_outliers.txt", header = TRUE, sep = "\t")
#smoker_male$GeneSymbol <- as.character(smoker_male$GeneSymbol)
#colnames(smoker_male)[2] <- "smoker_male"

#smoker_asian <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Smoking_Region_up_smoker_asian_non-smoker_asian___sig_outliers.txt", header = TRUE, sep = "\t")
#smoker_asian$GeneSymbol <- as.character(smoker_asian$GeneSymbol)
#colnames(smoker_asian)[2] <- "smoker_asian"

smoker_western <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Smoking_Region_up_smoker_western_non-smoker_western___sig_outliers.txt", header = TRUE, sep = "\t")
smoker_western$GeneSymbol <- as.character(smoker_western$GeneSymbol)
colnames(smoker_western)[2] <- "smoker_western"

smoker_egfr <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Smoking_EGFR_up_smoker_1_non-smoker_1___sig_outliers.txt", header = TRUE, sep = "\t")
smoker_egfr$GeneSymbol <- as.character(smoker_egfr$GeneSymbol)
colnames(smoker_egfr)[2] <- "smoker_egfr"

#smoker_kras <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Smoking_KRAS_up_smoker_1_non-smoker_1___sig_outliers.txt", header = TRUE, sep = "\t")
#smoker_kras$GeneSymbol <- as.character(smoker_kras$GeneSymbol)
#colnames(smoker_kras)[2] <- "smoker_kras"

smoker_tp53 <- read.table("./comparison_results_2_dgidb_fdr_0.01/luad2_phos_dgidb_Smoking_TP53_up_smoker_1_non-smoker_1___sig_outliers.txt", header = TRUE, sep = "\t")
smoker_tp53$GeneSymbol <- as.character(smoker_tp53$GeneSymbol)
colnames(smoker_tp53)[2] <- "smoker_tp53"

###

phos_dgidb <- full_join(egfr_all, egfr_female, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, egfr_male, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, egfr_asian, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, egfr_western, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, kras_all, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, kras_female, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, kras_male, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, kras_asian, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, kras_western, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, tp53_all, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, tp53_female, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, tp53_male, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, tp53_asian, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, tp53_western, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, region_all, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, region_female, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, region_male, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, gender_all, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, gender_asian, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, gender_western, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, smoking_all, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, smoker_female, by = "GeneSymbol")
#phos_dgidb <- full_join(phos_dgidb, smoker_male, by = "GeneSymbol")
#phos_dgidb <- full_join(phos_dgidb, smoker_asian, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, smoker_western, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, smoker_egfr, by = "GeneSymbol")
phos_dgidb <- full_join(phos_dgidb, smoker_tp53, by = "GeneSymbol")
#phos_dgidb <- full_join(phos_dgidb, smoker_kras, by = "GeneSymbol")

phos_dgidb[is.na(phos_dgidb)] <- 0

###

phos_dgidb_gene <- phos_dgidb[,-1]
rownames(phos_dgidb_gene) <- phos_dgidb[,1]
cohorts_all <- colnames(phos_dgidb_gene)
phos_dgidb_annotation <- HeatmapAnnotation(df = as.data.frame(cohorts_all),
                                       col = list(cohorts_all = c(egfr_all = "coral",
                                                              egfr_female = "dodgerblue4",
                                                              egfr_male = "dodgerblue1",
                                                              egfr_asian = "deepskyblue4",
                                                              egfr_western = "deepskyblue2",
                                                              kras_all = "coral",
                                                              kras_female = "mediumorchid4",
                                                              kras_male = "mediumorchid1",
                                                              kras_asian = "mediumpurple4",
                                                              kras_western = "mediumpurple1",
                                                              tp53_all = "coral",
                                                              tp53_female = "olivedrab4",
                                                              tp53_male = "olivedrab3",
                                                              tp53_asian = "darkgreen",
                                                              tp53_western = "springgreen4",
                                                              region_all = "coral",
                                                              region_female = "darkorange3",
                                                              region_male = "darkorange",
                                                              gender_all = "coral",
                                                              gender_asian = "darkgoldenrod3",
                                                              gender_western = "darkgoldenrod1",
                                                              smoking_all = "coral",
                                                              smoker_female = "lightsteelblue4",
                                                              #smoker_male = "lightsteelblue1",
                                                              #smoker_asian = "mistyrose4",
                                                              smoker_western = "mistyrose2",
                                                              smoker_egfr = "aquamarine4",
                                                              #smoker_kras = "aquamarine3",
                                                              smoker_tp53 = "aquamarine1")))

phos_dgidb_heat <- Heatmap(phos_dgidb_gene,
                         top_annotation = phos_dgidb_annotation,
                         show_column_names = F, 
                         show_row_names = T,
                         cluster_rows = F,
                         cluster_columns = F,
                         row_names_gp = gpar(fontsize = 0),
                         top_annotation_height = unit(1, "cm"),
                         heatmap_legend_param = list(legend_height = unit(3, "in"),
                                                     title = NULL),
                         col = colorRamp2(c(0, 1.0e-50, 0.0001, 0.01), 
                                          c("gray85", "red3", "orangered2", "oldlace")),
                         row_title = "Q Value",
                         row_title_gp = gpar(fontsize = 10))
  
phos_dgidb_heat_2 <- draw(phos_dgidb_heat, heatmap_legend_side = "left")

```


---

```{r}

# DGIDB

# Filterd
druggable_dgidb <- rownames(phos_dgidb_gene)
length(druggable_dgidb) #63

# Query 
result_drug_dgidb <- queryDGIdb(druggable_dgidb)

```

```{r}

## Result summary
# Score is the total number of source databases listing the interaction (including PubMed articles)
summary_drug_dgidb <- resultSummary(result_drug_dgidb) 
summary_drug_dgidb_score <- dplyr::select(summary_drug_dgidb, Gene, Score)

# Change to numeric and aggregate for total score
summary_drug_dgidb_score$Score <- as.numeric(summary_drug_dgidb_score$Score)
summary_drug_dgidb_score <- aggregate(. ~ Gene, data = summary_drug_dgidb_score, sum)

# Get log score
summary_drug_dgidb_score$Log_Score <- log(summary_drug_dgidb_score$Score)

# Order rows to match heatmap
target <- as.vector(rownames(phos_dgidb_gene))
summary_drug_dgidb_score <- summary_drug_dgidb_score[match(target, summary_drug_dgidb_score$Gene),]

# Label row names for heatmap
row.names(summary_drug_dgidb_score) <- target

# Replace NA with 0 for plotting
summary_drug_dgidb_score$Score[is.na(summary_drug_dgidb_score$Score) == TRUE] <- 0
summary_drug_dgidb_score$Log_Score[is.na(summary_drug_dgidb_score$Log_Score) == TRUE] <- 0


summary_drug_dgidb_score

```


---

```{r}

# Import manual interactions then aggregate and separate into 1/0
interactions <- read.delim("./druggable/DGIDB_gene_drug_interactions_20190417_modified_dup_removed.txt", sep = "\t")
interactions <- interactions[interactions$gene_name %in% druggable_dgidb ,]

# Select gene name and interaction type only
interactions <- dplyr::select(interactions, gene_name, interaction_types)

# Aggregate to a list
interactions <- aggregate(interaction_types ~ gene_name, interactions, paste, collapse = ",")

# Order rows to match heatmap
target_int <- as.vector(druggable_dgidb)
interactions <- interactions[match(target_int, interactions$gene_name),]

interactions

```

```{r}

# Rename columns
colnames(interactions)[1:2] <- c("gene", "interaction_type")


# if interaction_type includes this exact match, put 1 else put 0 

interactions <- separate(interactions, interaction_type, 
                         into=c("int_1", "int_2", "int_3", "int_4", "int_5"), sep="," )
interactions$int_1[interactions$int_1==''] <- NA
interactions$int_1[is.na(interactions$int_1) == TRUE] <- 0
interactions$int_2[is.na(interactions$int_2) == TRUE] <- 0
interactions$int_3[is.na(interactions$int_3) == TRUE] <- 0
interactions$int_4[is.na(interactions$int_4) == TRUE] <- 0
interactions$int_5[is.na(interactions$int_5) == TRUE] <- 0

interactions

interactions$Antagonist <-ifelse((interactions$int_1 == "antagonist" |
                                interactions$int_2 == "antagonist" |
                                interactions$int_3 == "antagonist" |
                                interactions$int_4 == "antagonist" |
                                interactions$int_5 == "antagonist"), 1, 0)

interactions$Inhibitor <-ifelse((interactions$int_1 == "inhibitor" |
                                interactions$int_2 == "inhibitor" |
                                interactions$int_3 == "inhibitor" |
                                interactions$int_4 == "inhibitor" |
                                interactions$int_5 == "inhibitor"), 1, 0)

interactions$Agonist <-ifelse((interactions$int_1 == "agonist" |
                                interactions$int_2 == "agonist" |
                                interactions$int_3 == "agonist" |
                                interactions$int_4 == "agonist" |
                                interactions$int_5 == "agonist"), 1, 0)

interactions$Antibody <-ifelse((interactions$int_1 == "antibody" |
                                interactions$int_2 == "antibody" |
                                interactions$int_3 == "antibody" |
                                interactions$int_4 == "antibody" |
                                interactions$int_5 == "antibody"), 1, 0)

interactions$Activator <-ifelse((interactions$int_1 == "activator" |
                                interactions$int_2 == "activator" |
                                interactions$int_3 == "activator" |
                                interactions$int_4 == "activator" |
                                interactions$int_5 == "activator"), 1, 0)

interactions$Binder <-ifelse((interactions$int_1 == "binder" |
                                interactions$int_2 == "binder" |
                                interactions$int_3 == "binder" |
                                interactions$int_4 == "binder" |
                                interactions$int_5 == "binder"), 1, 0)

interactions$Blocker <-ifelse((interactions$int_1 == "blocker" | 
                                 interactions$int_1 == "channel blocker" |
                                interactions$int_2 == "blocker" | 
                                 interactions$int_2 == "channel blocker" |
                                interactions$int_3 == "blocker" | 
                                 interactions$int_3 == "channel blocker" |
                                interactions$int_4 == "blocker" | 
                                 interactions$int_4 == "channel blocker" |
                                interactions$int_5 == "blocker" | 
                                 interactions$int_5 == "channel blocker"), 1, 0)

interactions$Other <-ifelse((interactions$int_1 == "antisense" |
                               interactions$int_1 == "vaccine" |
                                interactions$int_2 == "antisense" |
                               interactions$int_2 == "vaccine" |
                                interactions$int_3 == "antisense" |
                               interactions$int_3 == "vaccine" |
                                interactions$int_4 == "antisense" |
                               interactions$int_4 == "vaccine" |
                                interactions$int_5 == "antisense" |
                               interactions$int_5 == "vaccine"), 1, 0)


interactions_final <- dplyr::select(interactions, -int_1, -int_2, -int_3, -int_4, -int_5)
interactions_final


# Aggregate and sum by gene name 
interactions_agg <- aggregate(. ~ gene, data = interactions_final, max)

# Order rows to match heatmap
target_int <- as.vector(druggable_dgidb)
interactions_agg <- interactions_agg[match(target_int, interactions_agg$gene),]

# Label row names for heatmap
row.names(interactions_agg) <- target_int
interactions_agg

# Remove gene column
interactions_agg <- dplyr::select(interactions_agg, -gene)

# Replace NA with 0 for plotting
interactions_agg[is.na(interactions_agg)] <- 0

interactions_agg$Inhibitor[interactions_agg$Inhibitor == 1] <- "Inhibitor"
interactions_agg$Antagonist[interactions_agg$Antagonist == 1] <- "Antagonist"
interactions_agg$Agonist[interactions_agg$Agonist == 1] <- "Agonist"
interactions_agg$Antibody[interactions_agg$Antibody == 1] <- "Antibody"
interactions_agg$Activator[interactions_agg$Activator == 1] <- "Activator"
interactions_agg$Binder[interactions_agg$Binder == 1] <- "Binder"
interactions_agg$Blocker[interactions_agg$Blocker == 1] <- "Blocker"
interactions_agg$Other[interactions_agg$Other == 1] <- "Other"

interactions_agg[interactions_agg == 0 ] <- "NA"

interactions_agg

```


---


```{r}

# FDA approved drugs 
fda <- read.table("./druggable/druggable_FDA_approved_2019-04-17_list.txt")
fda$FDA_approved <- "True"
colnames(fda)[1] <- c("gene")

# Intersect with druggable genes
fda_int <- as.data.frame(row.names(interactions_agg))
colnames(fda_int) <- c("gene")
fda_int <- left_join(fda_int, fda, by = "gene")

# Change NA to 
fda_int$FDA_approved[is.na(fda_int$FDA_approved) == TRUE] <- "False"
fda_int

```


---


```{r}

### Final Figure Heatmap: Druggable Filtered ###`

# Druggable Heatmap
phos_drug_dgidb_annotation <- HeatmapAnnotation(Comparison = c(rep('EGFR', 5), rep('KRAS', 5), 
                                                    rep('TP53', 5), rep('Region', 3), 
                                                    rep('Gender', 3), rep('Smoker', 5)), 
                                       Cohort = c("All", "Female", "Male", "Asian", "Western",
                                                  "All", "Female", "Male", "Asian", "Western", 
                                                  "All", "Female", "Male", "Asian", "Western", 
                                                  "All", "Female", "Male", 
                                                  "All", "Asian", "Western", 
                                                  "All", "Female", "Western", 
                                                  "EGFR_Mutation", "TP53_Mutation"),
                                       col = list(Comparison = c(EGFR = "#EF7C12",
                                                              KRAS = "#FFB90F",
                                                              TP53 = "#F7E690",
                                                              Region = "#EFC7E6",
                                                              Gender = "#CB87B4",
                                                              Smoker = "#B25D91"),
                                                  Cohort = c(All = "Black",
                                                             Female = "#AFDFEF",
                                                             Male = "#54BCD1" ,
                                                              Asian = "#0076C0",
                                                              Western = "#27408B", ##27408B
                                                            EGFR_Mutation = "#EDA9AB",
                                                              TP53_Mutation = "#D9565C")),
                                       annotation_legend_param = list(legend_height = unit(1, "cm"),
                                                                   legend_width = unit(0.20, "cm"),
                                                                   title_gp = gpar(fontsize = 11),
                                                                   labels_gp = gpar(fontsize = 9)),
                                       name = "phos_heat_anno")

phos_heat_drug_dgidb <- Heatmap(phos_dgidb_gene,
                                name = "phos_heat",
                         top_annotation = phos_drug_dgidb_annotation,
                         show_column_names = F, 
                         show_row_names = T,
                         cluster_rows = F,
                         cluster_columns = F,
                         row_names_gp = gpar(fontsize = 6),
                         top_annotation_height = unit(1, "cm"),
                         heatmap_legend_param = list(legend_height = unit(1, "cm"),
                                                     legend_width = unit(0.20, "cm"),
                                                     title = "Q Value",
                                                     title_gp = gpar(fontsize = 11),
                                                     labels_gp = gpar(fontsize = 9)),
                         col = colorRamp2(c(0, 1.0e-50, 0.0001, 0.01), 
                                          c("gray90", "red3", "orangered2", "oldlace")),
                         row_title_gp = gpar(fontsize = 10),
                         rect_gp = gpar(col = "white", lwd = 0.75))

# Decorate heatmap
phos_heat_drug_dgidb_fig <- draw(phos_heat_drug_dgidb, heatmap_legend_side = "right")


# Creat heatmap color scheme
colors <-  structure(c("#3C5541", "#3C8C4D", "#3CBC38", 
                       "#AFDE62", "#DFCEE0", "#CDB5CD",
                       "#7473A6", "#132157", "gray90"), 
                     names = c("Antagonist", "Inhibitor", "Agonist", "Antibody", 
                               "Activator", "Binder",
                               "Blocker", "Other", "NA"))

# Heatmap annotations 
#long_cn <- colnames(detail_agg_drug)
#ha_rot_cn <- HeatmapAnnotation(text = anno_text(long_cn, rot = 45, just = "left", offset = unit(1, "mm"), gp = gpar(fontsize = 7)))

ha_rot_cn_dgidb <- HeatmapAnnotation(Interaction = c("Antagonist","Inhibitor","Agonist", "Antibody", 
                                                     "Activator", "Binder", "Blocker", "Other"),
                               col = list(Interaction = c(Antagonist = "#3C5541",
                                                          Inhibitor = "#3C8C4D",
                                                          Agonist = "#3CBC38",
                                                          Antibody = "#AFDE62",
                                                          Activator = "#DFCEE0",
                                                          Binder = "#CDB5CD",
                                                          Blocker = "#7473A6",
                                                          Other = "#132157")),
                               annotation_legend_param = list(legend_height = unit(1, "cm"),
                                                              title = "Interaction",
                                                              legend_width = unit(0.20, "cm"),
                                                              title_gp = gpar(fontsize = 11),
                                                              labels_gp = gpar(fontsize = 9)),
                               show_legend = FALSE)


# Barplot
row_anno_dgidb <- rowAnnotation(barplot = row_anno_barplot(summary_drug_dgidb_score$Log_Score,
                          axis_direction = "reverse", border = TRUE, axis = TRUE, axis_side = "top",
                          gp = gpar(fill = "black")), 
                          width = unit(2, "cm"))

                             
# Create heatmap
interactions_drug_dgidb_heat <- Heatmap(interactions_agg,
                         show_column_names = F, 
                         show_row_names = T,
                         cluster_rows = F,
                         cluster_columns = F,
                         row_names_gp = gpar(fontsize = 0),
                         column_names_gp = gpar(fontsize = 2),
                         top_annotation_height = unit(1, "cm"),
                         show_heatmap_legend = TRUE,
                         heatmap_legend_param = list(legend_height = unit(1, "cm"),
                                                     legend_width = unit(0.20, "cm"),
                                                     title = "Interaction",
                                                     title_gp = gpar(fontsize = 11),
                                                     labels_gp = gpar(fontsize = 9)),
                         col = colors,
                         row_title_gp = gpar(fontsize = 10),
                         column_names_side = "top",
                         top_annotation = ha_rot_cn_dgidb,
                         width = unit(2, "cm"),
                         rect_gp = gpar(col = "white", lwd = 0.75),
                         name = "phos_int")

# Colors for FDA heatmap
colors_2 <-  structure(c("#007BC3", "#AFDFEF"), 
                     names = c("True", "False"))


# Create FDA heatmap
fda_drug_dgidb_heat <- Heatmap(fda_int$FDA_approved,
                         show_column_names = F, 
                         show_row_names = F,
                         cluster_rows = F,
                         cluster_columns = F,
                         row_names_gp = gpar(fontsize = 0),
                         column_names_gp = gpar(fontsize = 2),
                         top_annotation_height = unit(1, "cm"),
                         show_heatmap_legend = TRUE,
                         heatmap_legend_param = list(legend_height = unit(1, "cm"),
                                                     legend_width = unit(0.20, "cm"),
                                                     title = "FDA Approved",
                                                     title_gp = gpar(fontsize = 11),
                                                     labels_gp = gpar(fontsize = 9)),
                         col = colors_2,
                         row_title_gp = gpar(fontsize = 10),
                         rect_gp = gpar(col = "white", lwd = 0.75))


#detail_drug_heat
lgd <- Legend(labels = "Score", title = "Druggability", 
              legend_gp = gpar(fill = "black"),
              title_gp = gpar(fontsize = 11),
              labels_gp = gpar(fontsize = 9))

```

---

```{r}

final_druggable <- draw(row_anno_dgidb + fda_drug_dgidb_heat +
                          interactions_drug_dgidb_heat + phos_heat_drug_dgidb_fig,
                        gap = unit(c(2, 2, 0, 0), "mm"), annotation_legend_list = list(lgd))

decorate_heatmap_body("phos_heat", {
	grid.rect(0, 0, width = 5/26, height = 1.11, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})

decorate_heatmap_body("phos_heat", {
	grid.rect(5/26, 0, width = 5/26, height = 1.11, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})

decorate_heatmap_body("phos_heat", {
	grid.rect(10/26, 0, width = 5/26, height = 1.11, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})

decorate_heatmap_body("phos_heat", {
	grid.rect(15/26, 0, width = 3/26, height = 1.11, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})

decorate_heatmap_body("phos_heat", {
	grid.rect(18/26, 0, width = 3/26, height = 1.11, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})

decorate_heatmap_body("phos_heat", {
	grid.rect(21/26, 0, width = 5/26, height = 1.11, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})


```


---

```{r}

png("phos_dgidb_final_druggable_heatmap.png", units="in", width=10, height=6, res=800)

final_druggable <- draw(row_anno_dgidb + fda_drug_dgidb_heat +
                          interactions_drug_dgidb_heat + phos_heat_drug_dgidb_fig,
                        gap = unit(c(2, 2, 0, 0), "mm"), annotation_legend_list = list(lgd))

decorate_heatmap_body("phos_heat", {
	grid.rect(0, 0, width = 5/26, height = 1.08, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})

decorate_heatmap_body("phos_heat", {
	grid.rect(5/26, 0, width = 5/26, height = 1.08, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})

decorate_heatmap_body("phos_heat", {
	grid.rect(10/26, 0, width = 5/26, height = 1.08, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})

decorate_heatmap_body("phos_heat", {
	grid.rect(15/26, 0, width = 3/26, height = 1.08, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})

decorate_heatmap_body("phos_heat", {
	grid.rect(18/26, 0, width = 3/26, height = 1.08, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})

decorate_heatmap_body("phos_heat", {
	grid.rect(21/26, 0, width = 5/26, height = 1.08, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})

decorate_heatmap_body("phos_int", {
	grid.rect(0, 0, width = 1, height = 1.08, just = c("left", "bottom"), 
		gp = gpar(lwd = 0.75, col = "black", fill = "transparent"))
})


dev.off()


```


---




---





---





---




---



---

# Proteome FDR 0.05

---


```{r}

##### All Upregulated, filtered for DGIDB direct interaction list: Proteome #####

# Read in all phosphoproteome significant outliers 
# join all by gene name
# leave significance 
# make this into a heatmap


gender_all_prot <- read.table("./comparison_results_1_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Gender_up_female__male____sig_outliers.txt", header = TRUE, sep = "\t")
gender_all_prot$GeneSymbol <- as.character(gender_all_prot$GeneSymbol)
colnames(gender_all_prot)[2] <- "gender_all_prot"

region_all_prot <- read.table("./comparison_results_1_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Region_up_asian__western____sig_outliers.txt", header = TRUE, sep = "\t")
region_all_prot$GeneSymbol <- as.character(region_all_prot$GeneSymbol)
colnames(region_all_prot)[2] <- "region_all_prot"

smoking_all_prot <- read.table("./comparison_results_1_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Smoking_up_smoker__non-smoker____sig_outliers.txt", header = TRUE, sep = "\t")
smoking_all_prot$GeneSymbol <- as.character(smoking_all_prot$GeneSymbol)
colnames(smoking_all_prot)[2] <- "smoking_all_prot"

egfr_all_prot <- read.table("./comparison_results_1_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_EGFR_up_1__0____sig_outliers.txt", header = TRUE, sep = "\t")
egfr_all_prot$GeneSymbol <- as.character(egfr_all_prot$GeneSymbol)
colnames(egfr_all_prot)[2] <- "egfr_all_prot"

kras_all_prot <- read.table("./comparison_results_1_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_KRAS_up_1__0____sig_outliers.txt", header = TRUE, sep = "\t")
kras_all_prot$GeneSymbol <- as.character(kras_all_prot$GeneSymbol)
colnames(kras_all_prot)[2] <- "kras_all_prot"

tp53_all_prot <- read.table("./comparison_results_1_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_TP53_up_1__0____sig_outliers.txt", header = TRUE, sep = "\t")
tp53_all_prot$GeneSymbol <- as.character(tp53_all_prot$GeneSymbol)
colnames(tp53_all_prot)[2] <- "tp53_all_prot"

egfr_female_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Gender_EGFR_up_female_1_female_0___sig_outliers.txt", header = TRUE, sep = "\t")
egfr_female_prot$GeneSymbol <- as.character(egfr_female_prot$GeneSymbol)
colnames(egfr_female_prot)[2] <- "egfr_female_prot"

egfr_male_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Gender_EGFR_up_male_1_male_0___sig_outliers.txt", header = TRUE, sep = "\t")
egfr_male_prot$GeneSymbol <- as.character(egfr_male_prot$GeneSymbol)
colnames(egfr_male_prot)[2] <- "egfr_male_prot"

kras_female_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Gender_KRAS_up_female_1_female_0___sig_outliers.txt", header = TRUE, sep = "\t")
kras_female_prot$GeneSymbol <- as.character(kras_female_prot$GeneSymbol)
colnames(kras_female_prot)[2] <- "kras_female_prot"

kras_male_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Gender_KRAS_up_male_1_male_0___sig_outliers.txt", header = TRUE, sep = "\t")
kras_male_prot$GeneSymbol <- as.character(kras_male_prot$GeneSymbol)
colnames(kras_male_prot)[2] <- "kras_male_prot"

tp53_female_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Gender_TP53_up_female_1_female_0___sig_outliers.txt", header = TRUE, sep = "\t")
tp53_female_prot$GeneSymbol <- as.character(tp53_female_prot$GeneSymbol)
colnames(tp53_female_prot)[2] <- "tp53_female_prot"

tp53_male_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Gender_TP53_up_male_1_male_0___sig_outliers.txt", header = TRUE, sep = "\t")
tp53_male_prot$GeneSymbol <- as.character(tp53_male_prot$GeneSymbol)
colnames(tp53_male_prot)[2] <- "tp53_male_prot"

egfr_asian_prot<- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Region_EGFR_up_asian_1_asian_0___sig_outliers.txt", header = TRUE, sep = "\t")
egfr_asian_prot$GeneSymbol <- as.character(egfr_asian_prot$GeneSymbol)
colnames(egfr_asian_prot)[2] <- "egfr_asian_prot"

egfr_western_prot<- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Region_EGFR_up_western_1_western_0___sig_outliers.txt", header = TRUE, sep = "\t")
egfr_western_prot$GeneSymbol <- as.character(egfr_western_prot$GeneSymbol)
colnames(egfr_western_prot)[2] <- "egfr_western_prot"

gender_asian_prot<- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Region_Gender_up_asian_female_asian_male___sig_outliers.txt", header = TRUE, sep = "\t")
gender_asian_prot$GeneSymbol <- as.character(gender_asian_prot$GeneSymbol)
colnames(gender_asian_prot)[2] <- "gender_asian_prot"

region_female_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Region_Gender_up_asian_female_western_female___sig_outliers.txt", header = TRUE, sep = "\t")
region_female_prot$GeneSymbol <- as.character(region_female_prot$GeneSymbol)
colnames(region_female_prot)[2] <- "region_female_prot"

region_male_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Region_Gender_up_asian_male_western_male___sig_outliers.txt", header = TRUE, sep = "\t")
region_male_prot$GeneSymbol <- as.character(region_male_prot$GeneSymbol)
colnames(region_male_prot)[2] <- "region_male_prot"

gender_western_prot<- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Region_Gender_up_western_female_western_male___sig_outliers.txt", header = TRUE, sep = "\t")
gender_western_prot$GeneSymbol <- as.character(gender_western_prot$GeneSymbol)
colnames(gender_western_prot)[2] <- "gender_western_prot"

kras_asian_prot<- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Region_KRAS_up_asian_1_asian_0___sig_outliers.txt", header = TRUE, sep = "\t")
kras_asian_prot$GeneSymbol <- as.character(kras_asian_prot$GeneSymbol)
colnames(kras_asian_prot)[2] <- "kras_asian_prot"

kras_western_prot<- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Region_KRAS_up_western_1_western_0___sig_outliers.txt", header = TRUE, sep = "\t")
kras_western_prot$GeneSymbol <- as.character(kras_western_prot$GeneSymbol)
colnames(kras_western_prot)[2] <- "kras_western_prot"

tp53_asian_prot<- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Region_TP53_up_asian_1_asian_0___sig_outliers.txt", header = TRUE, sep = "\t")
tp53_asian_prot$GeneSymbol <- as.character(tp53_asian_prot$GeneSymbol)
colnames(tp53_asian_prot)[2] <- "tp53_asian_prot"

tp53_western_prot<- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Region_TP53_up_western_1_western_0___sig_outliers.txt", header = TRUE, sep = "\t")
tp53_western_prot$GeneSymbol <- as.character(tp53_western_prot$GeneSymbol)
colnames(tp53_western_prot)[2] <- "tp53_western_prot"

smoker_female_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Smoking_Gender_up_smoker_female_non-smoker_female___sig_outliers.txt", header = TRUE, sep = "\t")
smoker_female_prot$GeneSymbol <- as.character(smoker_female_prot$GeneSymbol)
colnames(smoker_female_prot)[2] <- "smoker_female_prot"

smoker_male_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Smoking_Gender_up_smoker_male_non-smoker_male___sig_outliers.txt", header = TRUE, sep = "\t")
smoker_male_prot$GeneSymbol <- as.character(smoker_male_prot$GeneSymbol)
colnames(smoker_male_prot)[2] <- "smoker_male_prot"

smoker_asian_prot<- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Smoking_Region_up_smoker_asian_non-smoker_asian___sig_outliers.txt", header = TRUE, sep = "\t")
smoker_asian_prot$GeneSymbol <- as.character(smoker_asian_prot$GeneSymbol)
colnames(smoker_asian_prot)[2] <- "smoker_asian_prot"

smoker_western_prot<- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Smoking_Region_up_smoker_western_non-smoker_western___sig_outliers.txt", header = TRUE, sep = "\t")
smoker_western_prot$GeneSymbol <- as.character(smoker_western_prot$GeneSymbol)
colnames(smoker_western_prot)[2] <- "smoker_western_prot"

smoker_egfr_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Smoking_EGFR_up_smoker_1_non-smoker_1___sig_outliers.txt", header = TRUE, sep = "\t")
smoker_egfr_prot$GeneSymbol <- as.character(smoker_egfr_prot$GeneSymbol)
colnames(smoker_egfr_prot)[2] <- "smoker_egfr_prot"

smoker_kras_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Smoking_KRAS_up_smoker_1_non-smoker_1___sig_outliers.txt", header = TRUE, sep = "\t")
smoker_kras_prot$GeneSymbol <- as.character(smoker_kras_prot$GeneSymbol)
colnames(smoker_kras_prot)[2] <- "smoker_kras_prot"

smoker_tp53_prot <- read.table("./comparison_results_2_dgidb_fdr_0.05/luad2_prot_dgidb_0.05_Smoking_TP53_up_smoker_1_non-smoker_1___sig_outliers.txt", header = TRUE, sep = "\t")
smoker_tp53_prot$GeneSymbol <- as.character(smoker_tp53_prot$GeneSymbol)
colnames(smoker_tp53_prot)[2] <- "smoker_tp53_prot"

###

prot_dgidb <- full_join(egfr_all_prot, egfr_female_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, egfr_male_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, egfr_asian_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, egfr_western_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, kras_all_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, kras_female_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, kras_male_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, kras_asian_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, kras_western_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, tp53_all_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, tp53_female_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, tp53_male_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, tp53_asian_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, tp53_western_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, region_all_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, region_female_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, region_male_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, gender_all_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, gender_asian_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, gender_western_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, smoking_all_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, smoker_female_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, smoker_male_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, smoker_asian_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, smoker_western_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, smoker_egfr_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, smoker_tp53_prot, by = "GeneSymbol")
prot_dgidb <- full_join(prot_dgidb, smoker_kras_prot, by = "GeneSymbol")

prot_dgidb[is.na(prot_dgidb)] <- 0

###

prot_dgidb_gene <- prot_dgidb[,-1]
rownames(prot_dgidb_gene) <- prot_dgidb[,1]
cohorts_all_prot <- colnames(prot_dgidb_gene)
prot_dgidb_annotation <- HeatmapAnnotation(df = as.data.frame(cohorts_all_prot),
                                       col = list(cohorts_all_prot = c(egfr_all_prot = "coral",
                                                              egfr_female_prot = "dodgerblue4",
                                                              egfr_male_prot = "dodgerblue1",
                                                              egfr_asian_prot= "deepskyblue4",
                                                              egfr_western_prot= "deepskyblue2",
                                                              kras_all_prot = "coral",
                                                              kras_female_prot = "mediumorchid4",
                                                              kras_male_prot = "mediumorchid1",
                                                              kras_asian_prot= "mediumpurple4",
                                                              kras_western_prot= "mediumpurple1",
                                                              tp53_all_prot = "coral",
                                                              tp53_female_prot = "olivedrab4",
                                                              tp53_male_prot = "olivedrab3",
                                                              tp53_asian_prot= "darkgreen",
                                                              tp53_western_prot= "springgreen4",
                                                              region_all_prot = "coral",
                                                              region_female_prot = "darkorange3",
                                                              region_male_prot = "darkorange",
                                                              gender_all_prot = "coral",
                                                              gender_asian_prot= "darkgoldenrod3",
                                                              gender_western_prot= "darkgoldenrod1",
                                                              smoking_all_prot = "coral",
                                                              smoker_female_prot = "lightsteelblue4",
                                                              smoker_male_prot = "lightsteelblue1",
                                                              smoker_asian_prot= "mistyrose4",
                                                              smoker_western_prot= "mistyrose2",
                                                              smoker_egfr_prot = "aquamarine4",
                                                              smoker_kras_prot = "aquamarine3",
                                                              smoker_tp53_prot = "aquamarine1")))

prot_dgidb_heat <- Heatmap(prot_dgidb_gene,
                         top_annotation = prot_dgidb_annotation,
                         show_column_names = F, 
                         show_row_names = T,
                         cluster_rows = F,
                         cluster_columns = F,
                         row_names_gp = gpar(fontsize = 0),
                         top_annotation_height = unit(1, "cm"),
                         heatmap_legend_param = list(legend_height = unit(3, "in"),
                                                     title = NULL),
                         col = colorRamp2(c(0, 1.0e-50, 0.0001, 0.01), 
                                          c("gray85", "red3", "orangered2", "oldlace")),
                         row_title = "Q Value",
                         row_title_gp = gpar(fontsize = 10))
  
prot_dgidb_heat_2 <- draw(prot_dgidb_heat, heatmap_legend_side = "left")

```


---



---



---



---



---



---